{"ast":null,"code":"import TradeMarketABI from '../contracts/MarketPlace.json';\nimport Web3 from \"web3/dist/web3.min.js\";\nconst web3 = new Web3('wss://ws-mumbai.matic.today');\nconst TradeServiceADDR = '0x840B5ac3021fa2CF1Fa27490C1bCA2a173F8c931';\n\nconst tradeService = () => {\n  const contract_Instance = new web3.eth.Contract(TradeMarketABI, TradeServiceADDR);\n  return contract_Instance;\n};\n\nexport const getTradeBalance = async SEND_ADDR => {\n  return new Promise(resolve => {\n    tradeService().methods.getMyDeposit().call({\n      from: SEND_ADDR\n    }).then(result => {\n      resolve(result);\n    });\n  });\n};\nexport const eventMintTokn = async ADDR => {\n  return new Promise(resolve => {\n    mintService().events.tradingEvt({\n      filter: {\n        buyer: ADDR\n      },\n      fromBlock: 'latest'\n    }, (err, evt) => {\n      console.log('event call: ', evt);\n      resolve(evt.returnValues);\n    });\n  });\n};\nexport const tempbuynft = async (SEND_ADDR, PRIVATE_KEY, toknId, toknPrice) => {\n  console.log(SEND_ADDR, toknId, toknPrice);\n  const method = tradeService().methods.buyTokn(toknId);\n  const estGas = await method.estimateGas({\n    from: SEND_ADDR,\n    value: toknPrice\n  });\n  console.log(estGas);\n};\nexport const buyNFT = async (SEND_ADDR, PRIVATE_KEY, toknId, toknPrice) => {\n  const chainId = await web3.eth.getChainId();\n  const nonce = await web3.eth.getTransactionCount(SEND_ADDR, 'latest');\n  const method = tradeService().methods.buyTokn(toknId);\n  const gasPrice = await web3.eth.getGasPrice();\n  const code = await method.encodeABI();\n  return new Promise(resolve => {\n    method.estimateGas({\n      from: SEND_ADDR,\n      value: toknPrice\n    }).then(estGas => {\n      const tx = {\n        nonce: nonce,\n        chainId: chainId,\n        from: SEND_ADDR,\n        to: TradeServiceADDR,\n        value: toknPrice,\n        //web3.utils.toHex(web3.utils.toWei(toknPrice, 'ether')),\n        data: code,\n        gasPrice: gasPrice,\n        gas: estGas\n      };\n      signTrx(tx, PRIVATE_KEY).then(result => {\n        console.log(result);\n        resolve(result);\n      });\n    }).catch(err => {\n      console.log(err);\n      resolve(err);\n    });\n  });\n};\nexport const withdrawSaleToknPrice = async (SEND_ADDR, PRIVATE_KEY, amount) => {\n  const chainId = await web3.eth.getChainId();\n  const nonce = await web3.eth.getTransactionCount(SEND_ADDR, 'latest');\n  const method = await tradeService().methods.withDrawal(amount);\n  const gasPrice = await web3.eth.getGasPrice();\n  const code = await method.encodeABI();\n  return new Promise(resolve => {\n    method.estimateGas({\n      from: SEND_ADDR\n    }).then(estGas => {\n      const tx = {\n        nonce: nonce,\n        chainId: chainId,\n        from: SEND_ADDR,\n        to: TradeServiceADDR,\n        value: '0',\n        data: code,\n        gasPrice: gasPrice,\n        gas: estGas\n      };\n      signTrx(tx, PRIVATE_KEY).then(result => {\n        console.log(result);\n        resolve(result);\n      });\n    }).catch(err => {\n      console.log(err);\n      resolve(err);\n    });\n  });\n};\n\nconst signTrx = (tx, PRIVATE_KEY) => {\n  return new Promise(resolve => {\n    web3.eth.accounts.signTransaction(tx, PRIVATE_KEY).then(signedTx => {\n      web3.eth.sendSignedTransaction(signedTx.rawTransaction, function (error, hash) {\n        if (!error) resolve(true);else resolve('Check again your Private_Key inputed');\n      });\n    }).catch(err => {\n      console.log(err.message);\n      resolve(err.message);\n    });\n  });\n};","map":{"version":3,"names":["TradeMarketABI","Web3","web3","TradeServiceADDR","tradeService","contract_Instance","eth","Contract","getTradeBalance","SEND_ADDR","Promise","resolve","methods","getMyDeposit","call","from","then","result","eventMintTokn","ADDR","mintService","events","tradingEvt","filter","buyer","fromBlock","err","evt","console","log","returnValues","tempbuynft","PRIVATE_KEY","toknId","toknPrice","method","buyTokn","estGas","estimateGas","value","buyNFT","chainId","getChainId","nonce","getTransactionCount","gasPrice","getGasPrice","code","encodeABI","tx","to","data","gas","signTrx","catch","withdrawSaleToknPrice","amount","withDrawal","accounts","signTransaction","signedTx","sendSignedTransaction","rawTransaction","error","hash","message"],"sources":["/home/giparang/threadweb/fortune/client/src/utilityUnits/connTradeService.js"],"sourcesContent":["import TradeMarketABI from '../contracts/MarketPlace.json';\nimport Web3 from \"web3/dist/web3.min.js\";\nconst web3 = new Web3('wss://ws-mumbai.matic.today');\nconst TradeServiceADDR = '0x840B5ac3021fa2CF1Fa27490C1bCA2a173F8c931';\n\nconst tradeService = () => {\n  const contract_Instance = new web3.eth.Contract(\n    TradeMarketABI, TradeServiceADDR\n  )\n  return contract_Instance;\n}\n\nexport const getTradeBalance = async(SEND_ADDR) => {\n  return new Promise(resolve => {\n    tradeService().methods.getMyDeposit().call({from: SEND_ADDR}).then(\n      result => {\n        resolve(result);\n      }\n    )\n  })\n}\nexport const eventMintTokn = async(ADDR) => {\n  return new Promise(resolve => {\n      mintService().events.tradingEvt(\n          {filter: {buyer: ADDR},\n          fromBlock: 'latest'},\n           (err, evt) => {\n              console.log('event call: ', evt);\n              resolve(evt.returnValues);            \n      })\n  })\n}\n\nexport const tempbuynft = async(SEND_ADDR, PRIVATE_KEY, toknId, toknPrice) => {\n  console.log(SEND_ADDR, toknId, toknPrice);\n  const method = tradeService().methods.buyTokn(toknId);\n  const estGas = await method.estimateGas({from: SEND_ADDR, value: toknPrice});\n  console.log(estGas);\n}\nexport const buyNFT = async(SEND_ADDR, PRIVATE_KEY, toknId, toknPrice) => {\n  const chainId = await web3.eth.getChainId();\n  const nonce = await web3.eth.getTransactionCount(SEND_ADDR, 'latest');\n  const method = tradeService().methods.buyTokn(toknId);\n  const gasPrice = await web3.eth.getGasPrice();\n  const code = await method.encodeABI();\n  return new Promise(resolve => {\n    method.estimateGas({from: SEND_ADDR, value: toknPrice}).then(estGas => {\n      const tx = {\n        nonce: nonce,\n        chainId: chainId,\n        from: SEND_ADDR,\n        to: TradeServiceADDR,\n        value: toknPrice, //web3.utils.toHex(web3.utils.toWei(toknPrice, 'ether')),\n        data: code,\n        gasPrice: gasPrice,\n        gas: estGas\n      };\n      signTrx(tx, PRIVATE_KEY).then(result => {\n        console.log(result);\n        resolve(result);\n      })\n    }).catch(err => {\n      console.log(err);\n      resolve(err);\n    })\n  })\n}\n\nexport const withdrawSaleToknPrice = async(SEND_ADDR, PRIVATE_KEY, amount) => {\n  const chainId = await web3.eth.getChainId();\n  const nonce = await web3.eth.getTransactionCount(SEND_ADDR, 'latest');\n  \n  const method = await tradeService().methods.withDrawal(amount);\n  const gasPrice = await web3.eth.getGasPrice();\n  const code = await method.encodeABI();\n  return new Promise(resolve => {\n    method.estimateGas({from: SEND_ADDR}).then(estGas => {\n      const tx = {\n        nonce: nonce,\n        chainId: chainId,\n        from: SEND_ADDR,\n        to: TradeServiceADDR,\n        value: '0',\n        data: code,\n        gasPrice: gasPrice,\n        gas: estGas\n      }\n      signTrx(tx, PRIVATE_KEY).then(result => {\n        console.log(result);\n        resolve(result);\n      })\n    }).catch(err => {\n      console.log(err);\n      resolve(err);\n    })\n  })\n}\nconst signTrx = (tx, PRIVATE_KEY) => {\n  return new Promise(resolve => {\n    web3.eth.accounts.signTransaction(tx, PRIVATE_KEY).then(signedTx => {\n      web3.eth.sendSignedTransaction(signedTx.rawTransaction, function(error, hash) {\n        if (!error)\n          resolve(true);\n        else\n          resolve('Check again your Private_Key inputed');\n      });\n    }).catch(err => {\n      console.log(err.message);\n      resolve(err.message);\n    })\n  })\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}